---
title: "Puerto Rico Migration Flows: Project Proposal"
author: "Wendy Prudencio"
---

# Overview

Puerto Rico is a territorial island belonging to the United States and is home to an estimated 3.2 million people (Census, n.d). The archipelago is located in the Caribbean Sea and is susceptible to hurricanes, landslides, mudslides, earthquakes, and other natural hazards. In the last decade, Puerto Rico has experienced three major hurricanes, Irma, and Maria in 2017 and Fiona in 2022. Hurricanes Irma and Maria, category 4 and 5, respectively, destroyed critical infrastructure, hospitals, and damaged thousands of homes displacing thousands of Puerto Ricans.

After natural disasters, it is difficult to track individual movements from one location to another and even harder if the individuals move to a different state or country. For instance, Puerto Ricans have the ability to move from Puerto Rico to the continental U.S. because they are U.S. citizens and are not bound by international restrictions. Puerto Ricans have a unique status that makes it an interesting group to research due to their history, location, and disaster risk.

The primary goal of this project is research, compare, analyze, and document migration flows from Puerto Rico to the continental U.S. pre-and-post hurricanes Irma and Maria and possibly Fiona, if data is available.

# Data and approach

The data to support the goal of this project that I currently have includes data from the American Community Survey on population estimates from 2015-2019. I have data from the National Flood Insurance Program (NFIP) that received flood claims after the hurricanes in 2017. Additionally, I have found Puerto Rico on OpenStreetMap and a layer in ArcGIS that points to hospitals that were damaged during the hurricanes. Lastly, I can use Mapbox to obtain information such as hospital distance for a property x miles away.

I will probably have to combine some of the data because the data is in different formats. My approach is to explore the data and determine how to best analyze the data using what I have found thus far and be able to combine methodology to produce a visual.

## Questions

The questions I intend to answer are:

1.  Which year had the most migration from Puerto Rico to the continental U.S.?
2.  What continental U.S. state received the most influx of Puerto Rican individuals?
3.  Can I use flooding claims information to inform migration flow?

## Description of data

1.  The first dataset is from the American Community Survey with estimated population data for municipalities and census tracts. The ACS data is from 2015-2019, but I also have the census tracts from 2010-2018. I could use one or the other dataset to compare the number of individuals living on the island pre-and-post Hurricanes Irma and Maria. The ACS data is obtained through the U.S. Census Bureau to obtain population data and housing information and has a structure on the variables (Census, n.d.).

2.  The NFIP claims data was obtained from the Federal Emergency Management Agency website that has been collected through OpenFEMA that provides datasets to the public (FEMA, 2022). The purpose of the NFIP claims is to determine who had flooding insurance, reimbursement for damages, census tract, and elevation (FEMA, 2022). NFIP claims data does not have a standard or schema, but is organized by state. I have to clean data that is only relevant to Puerto Rico for 2017-2018.

3.  The last dataset was obtained from ArcGIS that includes data of 43 hospitals that were impacted by the hurricanes in 2017. The dataset has hospital names, addresses, coordinates, county FIPS codes, whether the hospital is public or private, and population. The purpose of the data was to support disaster recovery and only provide basic information.

I do not think there are any ethical issues around the collection of any of the 3 datasets and I do not anticipate any ethical issues from the work I plan on doing with the data. Each dataset contains different types of data for 3 different purposes, but I think that combining the data from each set will support the research questions.

## Preliminary Analysis

I started my exploratory analysis by using the R packages tidycensus, tidyverse, and tigris in RStudio to use ACS data to explore some population estimates and characteristics such as age and gender. Using the walkerke/tidycensus vignette from Github, I was able to start the exploratory migration flows in Puerto Rico using `get_flows()` function that provides movedin, movedout, and movednet variables with a margin of error for each column. The `get_flows()` function only uses the geography as county, county subdivision, or metropolitan statistical area, unfortunately it does not use state. Puerto Rico has 78 municipalities/ counties; therefore, I will start comparing the municipalities in 2015.

# References

American Community Survey. (n.d.). American Community Survey Tables: 2015--2019 (5-Year Estimates). Retrieved from https://www.socialexplorer.com/data/ACS2019_5yr/metadata/?ds=ACS19_5yr Federal

Emergency Management Agency. (2022). OpenFEMA Data Sets. Retrieved from https://www.fema.gov/about/openfema/data-sets#nfip

U.S. Census Bureau. (n.d.). Quickfacts Puerto Rico. Retrieved from https://www.census.gov/quickfacts/PR

# Links

ACS data is provided by: (https://www.socialexplorer.com/data/ACS2019_5yr/metadata/?ds=ACS19_5yr)

NFIP data is provided by: (https://www.fema.gov/about/openfema/data-sets#nfip)

OpenStreetMap: (https://www.openstreetmap.org/export#map=10/18.1700/-66.5099)

ArcGIS map: (https://www.arcgis.com/home/item.html?id=2e060b7232da44e2adf112795f1495b9)

```{r setup}
#| echo: false
library(tidycensus)
library(tidyverse)
library(tigris)
library(sf)
library(readxl)

options(tigris_use_cache = TRUE)
```

## ACS estimates for sex, age, and latino/a/x orgin in Puerto Rico

```{r}
pr_age_hisp <-
  get_estimates(
    geography = "state",
    product = "characteristics",
    breakdown = c("SEX", "AGEGROUP", "HISP"),
    breakdown_labels = TRUE,
    state = "PR"
  )

pr_age_hisp
```

## Migration per county/ municpality for 2015 in alphabetical order

```{r counties}
pr_counties <- tigris::counties(state = "PR", cb = TRUE)
```

```{r example_map_fn}
pr_counties_flows_2015 <-
  purrr::map_dfr(
    pr_counties$COUNTYFP,
    ~ get_flows(
      geography = "county",
      state = "PR",
      county = .x,
      year = 2015
    )
  )
```

```{r}
adjuntas15_flows <-
  get_flows(
    geography = "county",
    state = "PR",
    county = "MayagÃ¼ez",
    year = 2015
  )

adjuntas15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
aguada15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "aguada",
  year = 2015
)

aguada15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
aguadilla15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "aguadilla",
  year = 2015
)

aguadilla15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
aguasbue15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "aguas buenas",
  year = 2015
)

aguasbue15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
aibonito15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "aibonito",
  year = 2015
)

aibonito15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
anasco15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "anasco",
  year = 2015
)

anasco15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
arecibo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "arecibo",
  year = 2015
)

arecibo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
arroyo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "arroyo",
  year = 2015
)

arroyo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
barcelo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "barceloneta",
  year = 2015
)

barcelo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
barran15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "barranquitas",
  year = 2015
)

barran15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
bayamon15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "bayamon",
  year = 2015
)

bayamon15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
cabo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "cabo rojo",
  year = 2015
)

cabo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
caguas15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "caguas",
  year = 2015
)

caguas15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
camuy15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "camuy",
  year = 2015
)

camuy15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
canov15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "canovanas",
  year = 2015
)

canov15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
carolina15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "carolina",
  year = 2015
)

carolina15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
catano15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "catano",
  year = 2015
)

catano15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
cayey15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "cayey",
  year = 2015
)

cayey15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
ceiba15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "ceiba",
  year = 2015
)

ceiba15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
ciales15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "ciales",
  year = 2015
)

ciales15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
cidra15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "cidra",
  year = 2015
)

cidra15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
coamo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "coamo",
  year = 2015
)

coamo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
comerio15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "comerio",
  year = 2015
)

comerio15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
corozal15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "corozal",
  year = 2015
)

corozal15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
culebra15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "culebra",
  year = 2015
)

culebra15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
dorado15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "dorado",
  year = 2015
)

dorado15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
fajardo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "fajardo",
  year = 2015
)

fajardo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
florida15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "florida",
  year = 2015
)

florida15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
guanica15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "guanica",
  year = 2015
)

guanica15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
guayama15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "guayama",
  year = 2015
)

guayama15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
guayanil15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "guayanilla",
  year = 2015
)

guayanil15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
guaynabo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "guaynabo",
  year = 2015
)

guaynabo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
gurabo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "gurabo",
  year = 2015
)

gurabo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
hatillo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "hatillo",
  year = 2015
)

hatillo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
hormi15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "hormigueros",
  year = 2015
)

hormi15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
humacao15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "humacao",
  year = 2015
)

humacao15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
isabela15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "isabela",
  year = 2015
)

isabela15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
jayuya15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "jayuya",
  year = 2015
)
jayuya15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
juana15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "juana diaz",
  year = 2015
)

juana15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
juncos15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "juncos",
  year = 2015
)

juncos15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
lajas15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "lajas",
  year = 2015
)

lajas15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
lares15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "lares",
  year = 2015
)

lares15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
lasmaria15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "las marias",
  year = 2015
)

lasmaria15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
laspied15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "las piedras",
  year = 2015
)

laspied15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
loiza15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "loiza",
  year = 2015
)

loiza15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
luquillo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "luquillo",
  year = 2015
)

luquillo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
manati15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "manati",
  year = 2015
)

manati15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
maricao15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "maricao",
  year = 2015
)

maricao15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
mayaguez15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "mayaguez",
  year = 2015
)

mayaguez15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
moca15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "moca",
  year = 2015
)

moca15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
morovis15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "morovis",
  year = 2015
)

morovis15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
naguabo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "naguabo",
  year = 2015
)

naguabo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
naranjito15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "naranjito",
  year = 2015
)

naranjito15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
orocovis15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "orocovis",
  year = 2015
)

orocovis15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
patillas15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "patillas",
  year = 2015
)

patillas15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
penuela15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "penuelas",
  year = 2015
)

penuela15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
ponce15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "ponce",
  year = 2015
)

ponce15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
quebra15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "quebradillas",
  year = 2015
)

quebra15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
rincon15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "rincon",
  year = 2015
)

rincon15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
riog15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "rio grande",
  year = 2015
)

riog15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
sabana15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "sabana grande",
  year = 2015
)

sabana15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
salinas15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "salinas",
  year = 2015
)

salinas15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
sangerman15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "san german",
  year = 2015
)

sangerman15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
sanjuan15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "san juan",
  year = 2015
)

sanjuan15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
sanlorenzo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "san lorenzo",
  year = 2015
)

sanlorenzo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
sansebastian15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "san sebastian",
  year = 2015
)

sansebastian15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
santai15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "santa isabel",
  year = 2015
)

santai15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
toaalta15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "toa alta",
  year = 2015
)

toaalta15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
toabaja15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "toa baja",
  year = 2015
)

toabaja15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
trujillo15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "trujillo alto",
  year = 2015
)

trujillo15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
utuado15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "utuado",
  year = 2015
)

utuado15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
vegaalta15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "vega alta",
  year = 2015
)

vegaalta15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
vegabaja15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "vega baja",
  year = 2015
)

vegabaja15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
vieques15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "vieques",
  year = 2015
)

vieques15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
villalba15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "villalba",
  year = 2015
)

villalba15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
yabucoa15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "yabucoa",
  year = 2015
)

yabucoa15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

```{r}
yauco15_flows <- get_flows(
  geography = "county",
  state = "PR",
  county = "yauco",
  year = 2015
)

yauco15_flows %>%
  filter(!is.na(GEOID2)) %>%
  head()
```

## Is there a way to run all these codes for the years remainding?\*

## Import data from NFIP

```{r}
here::here(
  "data/FEMANFIPClaims_PR.xlsx"
)
```

```{r}
# FIXME: Read in FEMANFIPClaims_PR.xlsx
nfip_data <- ("data/FEMANFIPClaims_PR.xlsx")
```
